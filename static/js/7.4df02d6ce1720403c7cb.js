webpackJsonp([7],{Jo5P:function(e,t,a){a("R7Fu");var s=a("VU/8")(a("sfnm"),a("qa+k"),"data-v-7b5e27a4",null);e.exports=s.exports},R7Fu:function(e,t){},"qa+k":function(e,t){e.exports={render:function(){var a=this,e=a.$createElement,s=a._self._c||e;return s("section",[s("div",[s("el-row",{staticClass:"btnClass"},[s("div",{staticClass:"seach-left"},[s("search-table-data",{ref:"refSearchTable",attrs:{name:"ch-components-globalSearch-fileImport-search-date-data",pagesize:a.pagesize,startTime:a.startTime,endTime:a.endTime},on:{searchKey:a.searchListTable}}),a._v(" "),s("search-date-data",{ref:"refSearchDate",attrs:{name:"ch-components-globalSearch-fileImport-search-table-data",pagesize:a.pagesize,searchInput:a.searchInput},on:{searchDate:a.searchListTable}})],1)]),a._v(" "),[s("el-row",{staticClass:"rf-swap"},[s("el-table",{directives:[{name:"loading",rawName:"v-loading",value:a.loading,expression:"loading"}],staticStyle:{width:"100%"},attrs:{data:a.tableData.content,"tooltip-effect":"dark",id:"bm-com-global-search-tables-fileImport-table",height:"calc(100vh - 200px)"},on:{"sort-change":a.getOrder,"selection-change":a.handleSelectionChange}},[s("el-table-column",{attrs:{label:"名称",prop:"name",with:"100",sortable:"custom"},scopedSlots:a._u([{key:"default",fn:function(e){return[s("el-button",{attrs:{type:"text",size:"small"}},[a._v("\n                                "+a._s(e.row.name)+"\n                            ")])]}}])}),a._v(" "),s("el-table-column",{attrs:{label:"数据源",prop:"dataSource",with:"50",sortable:"custom"}}),a._v(" "),s("el-table-column",{attrs:{label:"同步对象",prop:"object",with:"50",sortable:"custom"},scopedSlots:a._u([{key:"default",fn:function(t){return["JDBC"==JSON.parse(t.row.taskJson).dataSource.type?s("el-button",{staticStyle:{"padding-left":"-15px"},attrs:{type:"text",size:"small"},on:{click:function(e){a.objectDialog(t.row.dataSourceId,t.row.object)}}},[a._v("\n                                "+a._s(t.row.object)+"\n                            ")]):s("span",[a._v(a._s(t.row.object))])]}}])}),a._v(" "),s("el-table-column",{attrs:{label:"周期情况",prop:"trigger",with:"50",sortable:"custom"},scopedSlots:a._u([{key:"default",fn:function(e){return[""==e.row.trigger?s("span",[a._v("单次执行")]):s("span",[a._v("周期执行")])]}}])}),a._v(" "),s("el-table-column",{attrs:{label:"创建时间",prop:"createTime",with:"50",formatter:a.dateFormat,sortable:"custom"}}),a._v(" "),s("el-table-column",{attrs:{label:"状态",prop:"status",width:"80",sortable:"custom"},scopedSlots:a._u([{key:"default",fn:function(e){return[0==e.row.status?s("div",{staticClass:"status-div-create"},[a._v("已创建")]):1==e.row.status?s("div",{staticClass:"status-div-deploy"},[a._v("已部署")]):2==e.row.status?s("div",{staticClass:"status-div-stop"},[a._v("已停止")]):-1==e.row.status?s("div",{staticClass:"status-div-error"},[a._v("错 误")]):s("div",[a._v("未知")])]}}])}),a._v(" "),s("el-table-column",{attrs:{label:"最后执行时间",prop:"lastExecuteTime",with:"50",formatter:a.dateFormat,sortable:"custom"}}),a._v(" "),s("el-table-column",{attrs:{label:"最后执行状态",prop:"lastExecuteStatus",with:"50",sortable:"custom"},scopedSlots:a._u([{key:"default",fn:function(e){return[0==e.row.lastExecuteStatus?s("div",[a._v("创建")]):1==e.row.lastExecuteStatus?s("div",[a._v("运行中")]):2==e.row.lastExecuteStatus?s("div",[a._v("完成")]):-1==e.row.lastExecuteStatus?s("div",[a._v("失败")]):-2==e.row.lastExecuteStatus?s("div",[a._v("终止")]):s("div",[a._v("未知")])]}}])})],1),a._v(" "),s("el-pagination",{attrs:{"current-page":a.currentPage,"page-sizes":[8,16,50,100],"page-size":a.pagesize,layout:"total, sizes, prev, pager, next, jumper",total:a.tableData.totalElements},on:{"size-change":a.handleSizeChange,"current-change":a.handleCurrentChange}})],1)],a._v(" "),s("el-dialog",{attrs:{title:"预览文件目录",visible:a.dialogTableVisible},on:{"update:visible":function(e){a.dialogTableVisible=e}}},[s("el-button",{attrs:{size:"small",type:"primary",round:""},on:{click:function(e){a.previewDir()}}},[a._v("根目录")]),a._v(" "),s("el-table",{attrs:{data:a.gridData}},[s("el-table-column",{attrs:{property:"name",label:"名称"},scopedSlots:a._u([{key:"default",fn:function(t){return[1==t.row.dir?s("el-button",{attrs:{type:"text"},on:{click:function(e){a.gotoDir(t.row.path)}}},[a._v(a._s(t.row.name))]):0==t.row.dir?s("el-button",{staticClass:"no-link",attrs:{type:"text",disabled:""}},[a._v(a._s(t.row.name))]):a._e()]}}])}),a._v(" "),s("el-table-column",{attrs:{property:"len",label:"大小(byte)",width:"200"}}),a._v(" "),s("el-table-column",{attrs:{property:"modificationTime",label:"最后修改时间",formatter:a.dateFormat}})],1)],1),a._v(" "),s("preview-task-name",{ref:"taskName"}),a._v(" "),s("preview-data-source",{ref:"dataSource"}),a._v(" "),s("preview-object",{ref:"object"}),a._v(" "),s("router-view")],2)])},staticRenderFns:[]}},sfnm:function(e,t,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var s=g(a("mvHQ")),r=g(a("6Kb7")),i=g(a("dwSd")),o=g(a("BfDE")),n=g(a("MHZg")),l=g(a("FKcr")),c=g(a("6MSL")),u=a("P9l9"),p=a("P9l9"),d=g(a("kMct")),h=g(a("DoGJ")),m=a("Wyan"),f=g(a("kM3G"));function g(e){return e&&e.__esModule?e:{default:e}}(0,m.queryObject)();t.default={components:{ElRow:h.default,ElCol:d.default,searchDateData:r.default,searchTableData:i.default,previewDataSet:o.default,previewObject:n.default,previewTaskName:l.default,previewDataSource:c.default},data:function(){return{cols:[],multipleSelection:[],option:"layout",tableData:{},show:!1,currentPage:1,pagesize:8,loading:!1,self:this,startTime:"",endTime:"",searchInput:"",parameter:"",form:"",dialogNewTaskJsonVisible:!1,dialogTableVisible:!1,formLabelWidth:"120px",gridData:[],prop:"lastModifiedTime",orderDirection:"DESC",rootPath:""}},methods:{getOrder:function(e){var t=this;if("ascending"===e.order?this.orderDirection="ASC":this.orderDirection="DESC",this.prop=e.prop,null===e.prop)return!(this.prop="lastModifiedTime");this.pagesize=8,this.currentPage=1,t.parameter=(0,m.createParameter)().Sort(e.prop,this.orderDirection).Build(),t.getSynchronizationTasks(t.parameter)},handleSizeChange:function(e){this.pagesize=e,this.parameter=(0,m.createParameter)().Build(this.buildParameters(this.pagesize,this.currentPage,this.startTime,this.endTime,this.searchInput)),this.getSynchronizationTasks(this.parameter,this.resType)},handleCurrentChange:function(e){this.currentPage=e,this.parameter=this.buildParameters(this.pagesize,this.currentPage,this.startTime,this.endTime,this.searchInput),this.getSynchronizationTasks(this.parameter,this.resType)},handleSelectionChange:function(e){this.multipleSelection=e},saveFlow:function(){var t=this;this.dialogNewTaskJsonVisible=!1,(0,p.postTaskJson)(this.form).then(function(e){t.getSynchronizationTasks(t.parameter)},function(e){t.$message({message:e.response.message,type:"error",duration:1500})})},searchListTable:function(e,t,a,s,r,i){var o=this;o.currentPage=1,i&&(o.pagesize=i),o.startTime=a,o.endTime=s,null!=r&&(o.searchInput=r);for(var n=o.parameter.fieldList.length,l=o.parameter.fieldList.slice(0),c=0;c<n;c++){if("undefined"===a||"lastModifiedTime"!==l[c].fieldName||"GREATER_THAN"!=l[c].comparatorOperator&&"LESS_THAN"!=l[c].comparatorOperator){if(null!=r&&"name"===l[c].fieldName){var u;-1<(u=o.parameter.fieldList.indexOf(l[c]))&&o.parameter.fieldList.splice(u,1)}}else-1<(u=o.parameter.fieldList.indexOf(l[c]))&&o.parameter.fieldList.splice(u,1)}o.parameter=o.buildParameters(o.pagesize,o.currentPage,o.startTime,o.endTime,o.searchInput,this.parameter.fieldList),this.parameter=(0,m.createParameter)().Sort(this.prop,this.orderDirection).Build(o.parameter,!1),this.getSynchronizationTasks(o.parameter)},getSynchronizationTasks:function(e){var t=this;e||(e=this.parameter),this.loading=!0,(0,u.getFileSynchronizationTaskList)(e).then(function(e){t.tableData=e,t.loading=!1},function(e){t.$message({message:e.response.message,type:"error",duration:1500})})},newTask:function(){localStorage.taskEntity=(0,s.default)({isCopy:!1}),this.$router.push({path:"/fileTask/add"})},copyTask:function(){this.multipleSelection[0].isCopy=!0,localStorage.taskEntity=(0,s.default)(this.multipleSelection[0]),this.$router.push({path:"/fileTask/add"})},gotoDir:function(e){var t=this,a=this;(0,u.getFileList)(e).then(function(e){a.gridData=e},function(e){t.$message({message:e.response.message,type:"error",duration:1500})}).catch(function(e){a.$confirm("无权限","错误",{type:"error"})})},delTable:function(){var t=this,a=this,s=[];this.multipleSelection.forEach(function(e,t){var a=e.id;s.push(a)}),a.$confirm("真的要删除"+s.length+"个数据导入任务?","提示",{}).then(function(){(0,u.deleteTasks)(s).then(function(e){a.getSynchronizationTasks(t.parameter),a.$message({message:"恭喜你，删除已成功！",type:"success"})},function(e){t.$message({message:e.response.message,type:"error",duration:1500})})}).catch(function(){})},startTask:function(){var t=this;if(this.multipleSelection){var a=this,s=[];this.multipleSelection.forEach(function(e){s.push(e.id)}),(0,u.startTasks)(s).then(function(e){a.getSynchronizationTasks()},function(e){t.$message({message:e.response.message,type:"error",duration:1500})})}},stopTask:function(){var t=this;if(this.multipleSelection){var a=this,s=[];this.multipleSelection.forEach(function(e){s.push(e.id)}),(0,u.stopTasks)(s).then(function(e){a.getSynchronizationTasks()},function(e){t.$message({message:e.response.message,type:"error",duration:1500})})}},nameDialog:function(e){this.$refs.taskName.nameDialog(e)},datasourceDialog:function(e){this.$refs.dataSource.datasourceDialog(e)},objectDialog:function(e,t){this.$refs.object.objectDialog(e,t)},previewDir:function(e){var t=this;if(e){var a=JSON.parse(e);this.dialogTableVisible=!0;var s=this;s.rootPath=a.dataStore.path,(0,u.getFileList)(a.dataStore.path).then(function(e){s.gridData=e},function(e){t.$message({message:e.response.message,type:"error",duration:1500})})}else(0,u.getFileList)(this.rootPath).then(function(e){t.gridData=e},function(e){t.$message({message:e.response.message,type:"error",duration:1500})})}},mounted:function(){var e=this;e.parameter=e.buildParameters(e.pagesize,e.currentPage,e.startTime,e.endTime,e.searchInput),e.getSynchronizationTasks(e.parameter),f.default.$on("refreshFileSynchronizationList",function(){e.getSynchronizationTasks()})},watch:{$route:function(e,t){var a=this;a.parameter=a.buildParameters(a.pagesize,a.currentPage,a.startTime,a.endTime,a.searchInput),a.getSynchronizationTasks(a.parameter),f.default.$on("refreshFileSynchronizationList",function(){a.getSynchronizationTasks()})}}}}});